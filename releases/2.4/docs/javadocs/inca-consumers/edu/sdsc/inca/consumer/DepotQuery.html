<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_05) on Thu Jul 03 13:49:54 PDT 2008 -->
<TITLE>
DepotQuery
</TITLE>

<META NAME="keywords" CONTENT="edu.sdsc.inca.consumer.DepotQuery class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="DepotQuery";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../edu/sdsc/inca/consumer/DepotBeanTest.html" title="class in edu.sdsc.inca.consumer"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../edu/sdsc/inca/consumer/DepotQueryTest.html" title="class in edu.sdsc.inca.consumer"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?edu/sdsc/inca/consumer/DepotQuery.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DepotQuery.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
edu.sdsc.inca.consumer</FONT>
<BR>
Class DepotQuery</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by ">java.util.TimerTask
      <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>edu.sdsc.inca.consumer.DepotQuery</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.lang.Runnable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>DepotQuery</B><DT>extends java.util.TimerTask</DL>
</PRE>

<P>
Handles the prefetching and caching of HQL queries to the depot.  The HQL
 queries allow users to request customized data from the depot.  In the
 event that a query takes a long time to load, this class can be used
 to continuously query results from the depot and store them.  The advantage
 of this is that whenever requests are made on the consumer for the data,
 the latest cached data can be returned immediately rather than waiting for
 the lengthy query to complete.  Furthermore, it will reduce the load on the
 consumer and depot.  If a cached query has parameters, it is a template
 for cached queries (e.g., get latest suite results for suite X)
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Shava Smallen &lt;ssmallen@sdsc.edu&gt;</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#QUERYDIR">QUERYDIR</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#DepotQuery(int, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.Object...)">DepotQuery</A></B>(int&nbsp;period,
           java.lang.String&nbsp;reloadAt,
           java.lang.String&nbsp;tempDir,
           java.lang.String&nbsp;name,
           java.lang.String&nbsp;command,
           java.lang.Object...&nbsp;params)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a new cache query thread for the specified query.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.io.File</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getCacheFile()">getCacheFile</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the handle of the file used to store the query result.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getCommand()">getCommand</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the depot command being used to fetch data from the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.Properties</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getDepotConfig()">getDepotConfig</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the configuration for connecting to the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getFreshResult()">getFreshResult</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Query the depot and return the results (rows) as an XmlBean</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getNextRefresh()">getNextRefresh</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check the age of the cached file and return the number of milliseconds
 before it should be refreshed again.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.Object[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getParams()">getParams</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the depot command params being used to fetch data from the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getPeriod()">getPeriod</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the frequency of queries to the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getQueryName()">getQueryName</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the name of the query.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getReloadAt()">getReloadAt</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the reload start time.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#getStoredResult()">getStoredResult</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the latest result of the query stored in the file cache.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#query()">query</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Send a query to the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#query(java.lang.String, java.lang.Object...)">query</A></B>(java.lang.String&nbsp;command,
      java.lang.Object...&nbsp;params)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Send a query to the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#refresh()">refresh</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Query the depot for a new result and store it in the cache</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#run()">run</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Will first check to see if there is a result already stored on disk and
 if so, will check to see how fresh it is.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#setCommand(java.lang.String)">setCommand</A></B>(java.lang.String&nbsp;command)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the depot query command being used to fetch data from the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#setDepotConfig(java.util.Properties)">setDepotConfig</A></B>(java.util.Properties&nbsp;depotConfig)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the configuration for connecting to the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#setParams(java.lang.Object[])">setParams</A></B>(java.lang.Object[]&nbsp;params)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the depot query command parameters being used to fetch data from the
 depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#setPeriod(int)">setPeriod</A></B>(int&nbsp;period)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the frequency of queries to the depot.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#setQueryName(java.lang.String)">setQueryName</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the name of the query.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#setReloadAt(java.lang.String)">setReloadAt</A></B>(java.lang.String&nbsp;reloadAt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the reload start time</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../edu/sdsc/inca/consumer/DepotQuery.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the query information as a string</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.util.TimerTask"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.util.TimerTask</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>cancel, scheduledExecutionTime</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="QUERYDIR"><!-- --></A><H3>
QUERYDIR</H3>
<PRE>
public static final java.lang.String <B>QUERYDIR</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#edu.sdsc.inca.consumer.DepotQuery.QUERYDIR">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="DepotQuery(int, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.Object...)"><!-- --></A><H3>
DepotQuery</H3>
<PRE>
public <B>DepotQuery</B>(int&nbsp;period,
                  java.lang.String&nbsp;reloadAt,
                  java.lang.String&nbsp;tempDir,
                  java.lang.String&nbsp;name,
                  java.lang.String&nbsp;command,
                  java.lang.Object...&nbsp;params)</PRE>
<DL>
<DD>Create a new cache query thread for the specified query.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>period</CODE> - The frequency of which the consumer should prefetch the
 query<DD><CODE>reloadAt</CODE> - Should be "*" if we don't care about the time the query
                 is started otherwise should be WW:HH:MM.<DD><CODE>tempDir</CODE> - A temporary directory where queries can be cached<DD><CODE>name</CODE> - The name of the query (may contain whitespace)<DD><CODE>command</CODE> - The depot query command<DD><CODE>params</CODE> - The parameters for the query command</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getCacheFile()"><!-- --></A><H3>
getCacheFile</H3>
<PRE>
public java.io.File <B>getCacheFile</B>()</PRE>
<DL>
<DD>Return the handle of the file used to store the query result.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>The file handle to the query result.</DL>
</DD>
</DL>
<HR>

<A NAME="getCommand()"><!-- --></A><H3>
getCommand</H3>
<PRE>
public java.lang.String <B>getCommand</B>()</PRE>
<DL>
<DD>Return the depot command being used to fetch data from the depot.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>A string containing a depot command.</DL>
</DD>
</DL>
<HR>

<A NAME="getDepotConfig()"><!-- --></A><H3>
getDepotConfig</H3>
<PRE>
public static java.util.Properties <B>getDepotConfig</B>()</PRE>
<DL>
<DD>Get the configuration for connecting to the depot.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>A properties list containing config parameters for connecting to
 the depot.</DL>
</DD>
</DL>
<HR>

<A NAME="getNextRefresh()"><!-- --></A><H3>
getNextRefresh</H3>
<PRE>
public long <B>getNextRefresh</B>()</PRE>
<DL>
<DD>Check the age of the cached file and return the number of milliseconds
 before it should be refreshed again.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Number of milliseconds before next refresh</DL>
</DD>
</DL>
<HR>

<A NAME="getParams()"><!-- --></A><H3>
getParams</H3>
<PRE>
public java.lang.Object[] <B>getParams</B>()</PRE>
<DL>
<DD>Return the depot command params being used to fetch data from the depot.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>A string array containing depot command parameters.</DL>
</DD>
</DL>
<HR>

<A NAME="getPeriod()"><!-- --></A><H3>
getPeriod</H3>
<PRE>
public int <B>getPeriod</B>()</PRE>
<DL>
<DD>Returns the frequency of queries to the depot.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>The number of seconds used to wait before querying the depot again.</DL>
</DD>
</DL>
<HR>

<A NAME="getQueryName()"><!-- --></A><H3>
getQueryName</H3>
<PRE>
public java.lang.String <B>getQueryName</B>()</PRE>
<DL>
<DD>Returns the name of the query.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>A string containing the name of the HQL query.</DL>
</DD>
</DL>
<HR>

<A NAME="getReloadAt()"><!-- --></A><H3>
getReloadAt</H3>
<PRE>
public java.lang.String <B>getReloadAt</B>()</PRE>
<DL>
<DD>Set the reload start time.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Should be "*" if we don't care about the time the query is started
 otherwise should be WW:HH:MM.</DL>
</DD>
</DL>
<HR>

<A NAME="getStoredResult()"><!-- --></A><H3>
getStoredResult</H3>
<PRE>
public java.lang.String <B>getStoredResult</B>()</PRE>
<DL>
<DD>Returns the latest result of the query stored in the file cache.  Does
 a synchronized read of the data from file and returns it.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>An XML document containing the results of the query or null if
 nothing has been cached yet or there are problems reading the file from
 disk.</DL>
</DD>
</DL>
<HR>

<A NAME="getFreshResult()"><!-- --></A><H3>
getFreshResult</H3>
<PRE>
public java.lang.String <B>getFreshResult</B>()
                                throws edu.sdsc.inca.ConfigurationException,
                                       java.io.IOException,
                                       edu.sdsc.inca.protocol.ProtocolException</PRE>
<DL>
<DD>Query the depot and return the results (rows) as an XmlBean
<P>
<DD><DL>

<DT><B>Returns:</B><DD>An XmlBean containing the query results.
<DT><B>Throws:</B>
<DD><CODE>edu.sdsc.inca.ConfigurationException</CODE> - if complete or incorrect depot parameters
<DD><CODE>java.io.IOException</CODE> - if trouble connecting to depot
<DD><CODE>edu.sdsc.inca.protocol.ProtocolException</CODE> - if trouble talking to depot</DL>
</DD>
</DL>
<HR>

<A NAME="query()"><!-- --></A><H3>
query</H3>
<PRE>
public java.lang.String <B>query</B>()
                       throws edu.sdsc.inca.ConfigurationException,
                              java.io.IOException</PRE>
<DL>
<DD>Send a query to the depot.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>An XML document complying to the queryResults schema
<DT><B>Throws:</B>
<DD><CODE>edu.sdsc.inca.ConfigurationException</CODE> - if problem with depot contact info
<DD><CODE>java.io.IOException</CODE> - iif trouble connecting to depot</DL>
</DD>
</DL>
<HR>

<A NAME="query(java.lang.String, java.lang.Object...)"><!-- --></A><H3>
query</H3>
<PRE>
public static java.lang.String <B>query</B>(java.lang.String&nbsp;command,
                                     java.lang.Object...&nbsp;params)
                              throws edu.sdsc.inca.ConfigurationException,
                                     java.io.IOException</PRE>
<DL>
<DD>Send a query to the depot.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>command</CODE> - The query command to call on the depot client
 (e.g., querySuite, queryHql, etc.)<DD><CODE>params</CODE> - The parameters for the query command
<DT><B>Returns:</B><DD>An XML document complying to the queryResults schema
<DT><B>Throws:</B>
<DD><CODE>edu.sdsc.inca.ConfigurationException</CODE> - if problem with depot contact info
<DD><CODE>java.io.IOException</CODE> - iif trouble connecting to depot</DL>
</DD>
</DL>
<HR>

<A NAME="run()"><!-- --></A><H3>
run</H3>
<PRE>
public void <B>run</B>()</PRE>
<DL>
<DD>Will first check to see if there is a result already stored on disk and
 if so, will check to see how fresh it is.  If the result is younger than
 the refreshSuiteCaching period, we will wait until it has expired before querying
 the depot.  Once the first query is made, this thread will continously
 query until it receives an interrupt.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE>run</CODE> in interface <CODE>java.lang.Runnable</CODE><DT><B>Specified by:</B><DD><CODE>run</CODE> in class <CODE>java.util.TimerTask</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="refresh()"><!-- --></A><H3>
refresh</H3>
<PRE>
public void <B>refresh</B>()
             throws edu.sdsc.inca.ConfigurationException,
                    java.io.IOException,
                    edu.sdsc.inca.protocol.ProtocolException</PRE>
<DL>
<DD>Query the depot for a new result and store it in the cache
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>edu.sdsc.inca.ConfigurationException</CODE> - if unable to read depot config params
<DD><CODE>java.io.IOException</CODE> - if unable to contact depot
<DD><CODE>edu.sdsc.inca.protocol.ProtocolException</CODE> - if trouble talking to depot</DL>
</DD>
</DL>
<HR>

<A NAME="setCommand(java.lang.String)"><!-- --></A><H3>
setCommand</H3>
<PRE>
public void <B>setCommand</B>(java.lang.String&nbsp;command)</PRE>
<DL>
<DD>Set the depot query command being used to fetch data from the depot.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>command</CODE> - A string containing a depot query command</DL>
</DD>
</DL>
<HR>

<A NAME="setDepotConfig(java.util.Properties)"><!-- --></A><H3>
setDepotConfig</H3>
<PRE>
public static void <B>setDepotConfig</B>(java.util.Properties&nbsp;depotConfig)</PRE>
<DL>
<DD>Set the configuration for connecting to the depot.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>depotConfig</CODE> - A properties list containing config parameters for
 connecting to the depot.</DL>
</DD>
</DL>
<HR>

<A NAME="setParams(java.lang.Object[])"><!-- --></A><H3>
setParams</H3>
<PRE>
public void <B>setParams</B>(java.lang.Object[]&nbsp;params)</PRE>
<DL>
<DD>Set the depot query command parameters being used to fetch data from the
 depot.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>params</CODE> - A string array containing parameters for a depot query
 command</DL>
</DD>
</DL>
<HR>

<A NAME="setPeriod(int)"><!-- --></A><H3>
setPeriod</H3>
<PRE>
public void <B>setPeriod</B>(int&nbsp;period)</PRE>
<DL>
<DD>Set the frequency of queries to the depot.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>period</CODE> - Set the number of seconds used to wait before querying the
 depot again.</DL>
</DD>
</DL>
<HR>

<A NAME="setQueryName(java.lang.String)"><!-- --></A><H3>
setQueryName</H3>
<PRE>
public void <B>setQueryName</B>(java.lang.String&nbsp;name)</PRE>
<DL>
<DD>Set the name of the query.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - A string containing the name of the HQL query.</DL>
</DD>
</DL>
<HR>

<A NAME="setReloadAt(java.lang.String)"><!-- --></A><H3>
setReloadAt</H3>
<PRE>
public void <B>setReloadAt</B>(java.lang.String&nbsp;reloadAt)</PRE>
<DL>
<DD>Set the reload start time
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>reloadAt</CODE> - Should be "*" if we don't care about the time the query
                 is started otherwise should be WW:HH:MM.</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD>Return the query information as a string
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>A string representation of the query</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../edu/sdsc/inca/consumer/DepotBeanTest.html" title="class in edu.sdsc.inca.consumer"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../edu/sdsc/inca/consumer/DepotQueryTest.html" title="class in edu.sdsc.inca.consumer"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?edu/sdsc/inca/consumer/DepotQuery.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DepotQuery.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
